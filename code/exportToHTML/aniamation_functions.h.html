<html>
<head>
<title>aniamation_functions.h</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bbb529;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6897bb;}
.s4 { color: #6a8759;}
.s5 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
aniamation_functions.h</font>
</center></td></tr></table>
<pre><span class="s0">#pragma </span><span class="s1">once</span>
<span class="s2">using namespace </span><span class="s1">std</span><span class="s2">;</span>
<span class="s2">namespace </span><span class="s1">game {</span>
    <span class="s2">namespace </span><span class="s1">animation {</span>
        <span class="s2">namespace </span><span class="s1">player {</span>
            <span class="s2">void </span><span class="s1">to_left(ship *obj</span><span class="s2">, bool </span><span class="s1">f = </span><span class="s2">false</span><span class="s1">) {</span>
                <span class="s2">if </span><span class="s1">(obj-&gt;get_sprite().getGlobalBounds().left - obj-&gt;get_speed().first &lt; </span><span class="s3">0</span>
                    <span class="s1">&amp;&amp; !f)</span>
                    <span class="s2">return;</span>
                <span class="s2">if </span><span class="s1">(obj-&gt;get_perspective_coef() &lt; </span><span class="s3">5</span><span class="s1">)</span>
                    <span class="s1">obj-&gt;get_perspective_coef() += </span><span class="s3">0.2 </span><span class="s1">* constants::delta_time</span><span class="s2">;</span>
                <span class="s1">obj-&gt;get_rect().left += -</span><span class="s3">1 </span><span class="s1">* obj-&gt;get_speed().first * constants::delta_time</span><span class="s2">;</span>
                <span class="s1">obj-&gt;get_sprite().move(-</span><span class="s3">1 </span><span class="s1">* obj-&gt;get_speed().first * constants::delta_time</span><span class="s2">, </span><span class="s3">0</span><span class="s1">)</span><span class="s2">;</span>
            <span class="s1">}</span>

            <span class="s2">void </span><span class="s1">to_right(ship *obj</span><span class="s2">, bool </span><span class="s1">f = </span><span class="s2">false</span><span class="s1">) {</span>
                <span class="s2">if </span><span class="s1">(obj-&gt;get_sprite().getGlobalBounds().left + obj-&gt;get_sprite().getGlobalBounds().width +</span>
                    <span class="s1">obj-&gt;get_speed().first &gt; </span><span class="s3">1920 </span><span class="s1">* constants::window_coef</span>
                    <span class="s1">&amp;&amp; !f)</span>
                    <span class="s2">return;</span>
                <span class="s2">if </span><span class="s1">(obj-&gt;get_perspective_coef() &gt; -</span><span class="s3">5</span><span class="s1">)</span>
                    <span class="s1">obj-&gt;get_perspective_coef() -= </span><span class="s3">0.2 </span><span class="s1">* constants::delta_time</span><span class="s2">;</span>
                <span class="s1">obj-&gt;get_rect().left += obj-&gt;get_speed().first * constants::delta_time</span><span class="s2">;</span>
                <span class="s1">obj-&gt;get_sprite().move(obj-&gt;get_speed().first * constants::delta_time</span><span class="s2">, </span><span class="s3">0</span><span class="s1">)</span><span class="s2">;</span>
            <span class="s1">}</span>

            <span class="s2">void </span><span class="s1">to_up(ship *obj</span><span class="s2">, bool </span><span class="s1">f = </span><span class="s2">false</span><span class="s1">) {</span>
                <span class="s2">if </span><span class="s1">(obj-&gt;get_sprite().getGlobalBounds().top - obj-&gt;get_speed().second &lt; </span><span class="s3">10 </span><span class="s1">* constants::window_coef</span>
                    <span class="s1">&amp;&amp; !f)</span>
                    <span class="s2">return;</span>
                <span class="s2">for </span><span class="s1">(</span><span class="s2">auto </span><span class="s1">&amp;i : obj-&gt;engines)</span>
                    <span class="s1">i.change_scale(</span><span class="s3">1.3</span><span class="s1">)</span><span class="s2">;</span>
                <span class="s1">obj-&gt;get_rect().top += (!f ? -</span><span class="s3">1 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">) * obj-&gt;get_speed().second * constants::delta_time</span><span class="s2">;</span>
                <span class="s1">obj-&gt;get_sprite().move(</span><span class="s3">0</span><span class="s2">, </span><span class="s1">(-</span><span class="s3">1 </span><span class="s1">* (!f) + </span><span class="s3">1 </span><span class="s1">* f) * obj-&gt;get_speed().second * constants::delta_time)</span><span class="s2">;</span>
            <span class="s1">}</span>

            <span class="s2">void </span><span class="s1">to_down(ship *obj</span><span class="s2">, bool </span><span class="s1">f = </span><span class="s2">false</span><span class="s1">) {</span>
                <span class="s2">if </span><span class="s1">(obj-&gt;get_sprite().getGlobalBounds().top + obj-&gt;get_sprite().getGlobalBounds().height +</span>
                    <span class="s1">obj-&gt;get_speed().second &gt; </span><span class="s3">1080 </span><span class="s1">* constants::window_coef</span>
                    <span class="s1">&amp;&amp; !f)</span>
                    <span class="s2">return;</span>
                <span class="s2">for </span><span class="s1">(</span><span class="s2">auto </span><span class="s1">&amp;i : obj-&gt;engines)</span>
                    <span class="s1">i.change_scale(</span><span class="s3">0.7</span><span class="s1">)</span><span class="s2">;</span>
                <span class="s1">obj-&gt;get_rect().top += (!f ? </span><span class="s3">0.4 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">) * obj-&gt;get_speed().second * constants::delta_time</span><span class="s2">;</span>
                <span class="s1">obj-&gt;get_sprite().move(</span><span class="s3">0</span><span class="s2">, </span><span class="s1">(!f ? </span><span class="s3">0.4 </span><span class="s1">: </span><span class="s3">1</span><span class="s1">) * obj-&gt;get_speed().second * constants::delta_time)</span><span class="s2">;</span>
            <span class="s1">}</span>

            <span class="s2">void </span><span class="s1">to_stay(ship *obj) {</span>
                <span class="s2">if </span><span class="s1">(obj-&gt;get_perspective_coef() &lt; </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s1">obj-&gt;get_perspective_coef() = std::min(obj-&gt;get_perspective_coef() + </span><span class="s3">0.15 </span><span class="s1">* constants::delta_time</span><span class="s2">,</span>
                                                           <span class="s3">0.0</span><span class="s1">)</span><span class="s2">;</span>
                <span class="s2">if </span><span class="s1">(obj-&gt;get_perspective_coef() &gt; </span><span class="s3">0</span><span class="s1">)</span>
                    <span class="s1">obj-&gt;get_perspective_coef() = std::max(obj-&gt;get_perspective_coef() - </span><span class="s3">0.15 </span><span class="s1">* constants::delta_time</span><span class="s2">,</span>
                                                           <span class="s3">0.0</span><span class="s1">)</span><span class="s2">;</span>
            <span class="s1">}</span>

            <span class="s2">void </span><span class="s1">to_stay_vertical(ship *obj) {</span>
                <span class="s2">for </span><span class="s1">(</span><span class="s2">auto </span><span class="s1">&amp;i : obj-&gt;engines)</span>
                    <span class="s1">i.change_scale(</span><span class="s3">1</span><span class="s1">)</span><span class="s2">;</span>
            <span class="s1">}</span>

            <span class="s2">void </span><span class="s1">destroy(game_object *obj) {</span>

            <span class="s1">}</span>

            <span class="s2">void </span><span class="s1">create_bullet(Rect&lt;</span><span class="s2">double</span><span class="s1">&gt; cords</span><span class="s2">, </span><span class="s1">pair&lt;</span><span class="s2">double, double</span><span class="s1">&gt; speed</span><span class="s2">, </span><span class="s1">game_elements &amp;game_elements) {</span>
                <span class="s1">cords.top /= constants::window_coef</span><span class="s2">;</span>
                <span class="s1">cords.left /= constants::window_coef</span><span class="s2">;</span>
                <span class="s1">game_elements.add_bullet(</span><span class="s2">new </span><span class="s1">bullet(cords</span><span class="s2">, </span><span class="s4">&quot;textures/game/player_bullet.png&quot;</span><span class="s2">, </span><span class="s1">speed</span><span class="s2">, </span><span class="s3">10</span><span class="s2">,</span>
                                                    <span class="s1">game_elements.enemy_ships_to_destroy</span><span class="s2">, </span><span class="s1">game_elements.bullets))</span><span class="s2">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">namespace </span><span class="s1">bullets {</span>
            <span class="s2">void </span><span class="s1">move(bullet *obj) {</span>
                <span class="s1">obj-&gt;get_sprite().move(obj-&gt;get_speed().first * constants::delta_time</span><span class="s2">,</span>
                                       <span class="s1">obj-&gt;get_speed().second * constants::delta_time)</span><span class="s2">;</span>
                <span class="s1">obj-&gt;try_to_kill()</span><span class="s2">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
        <span class="s2">namespace </span><span class="s1">enemy {</span>
            <span class="s2">void </span><span class="s1">create_bullet(Rect&lt;</span><span class="s2">double</span><span class="s1">&gt; cords</span><span class="s2">, </span><span class="s1">pair&lt;</span><span class="s2">double, double</span><span class="s1">&gt; speed</span><span class="s2">, </span><span class="s1">game_elements &amp;game_elements) {</span>
                <span class="s1">cords.top /= constants::window_coef</span><span class="s2">;</span>
                <span class="s1">cords.left /= constants::window_coef</span><span class="s2">;</span>
                <span class="s1">set&lt;ship*&gt;* sett = </span><span class="s2">new </span><span class="s1">set&lt;ship*&gt;</span><span class="s2">;</span>
                <span class="s1">sett-&gt;insert(game_elements.player_ship)</span><span class="s2">;</span>
                <span class="s1">game_elements.add_bullet(</span><span class="s2">new </span><span class="s1">bullet(cords</span><span class="s2">, </span><span class="s4">&quot;textures/game/bullet.png&quot;</span><span class="s2">, </span><span class="s1">speed</span><span class="s2">, </span><span class="s3">5</span><span class="s2">, </span><span class="s1">sett</span><span class="s2">, </span><span class="s1">game_elements.bullets))</span><span class="s2">;</span>
            <span class="s1">}</span>

            <span class="s2">void </span><span class="s1">move(enemy_ship *ship) {</span>
                <span class="s5">//ship-&gt;reload_texture();</span>
                <span class="s1">ship-&gt;check_to_kill()</span><span class="s2">;</span>
                <span class="s2">if </span><span class="s1">(ship-&gt;function_type == </span><span class="s3">1</span><span class="s1">) {</span>
                    <span class="s2">double </span><span class="s1">y = ship-&gt;function(ship-&gt;get_rect().left + ship-&gt;get_speed().first - ship-&gt;get_start().first) + ship-&gt;get_start().second</span><span class="s2">;</span>
                    <span class="s1">ship-&gt;get_speed().second = (y - ship-&gt;get_rect().top) / constants::delta_time</span><span class="s2">;</span>
                    <span class="s2">double </span><span class="s1">x = ship-&gt;get_speed().first</span><span class="s2">;</span>
                    <span class="s1">ship-&gt;get_speed().first = abs(x)</span><span class="s2">;</span>
                    <span class="s2">if </span><span class="s1">(x == </span><span class="s3">0</span><span class="s1">)</span>
                        <span class="s1">player::to_stay(ship)</span><span class="s2">;</span>
                    <span class="s2">else if </span><span class="s1">(x &lt; </span><span class="s3">0</span><span class="s1">)</span>
                        <span class="s1">player::to_left(ship</span><span class="s2">, </span><span class="s3">1</span><span class="s1">)</span><span class="s2">;</span>
                    <span class="s2">else</span>
                        <span class="s1">player::to_right(ship</span><span class="s2">, </span><span class="s3">1</span><span class="s1">)</span><span class="s2">;</span>

                    <span class="s2">if </span><span class="s1">(ship-&gt;get_speed().second == </span><span class="s3">0</span><span class="s1">)</span>
                        <span class="s1">player::to_stay_vertical(ship)</span><span class="s2">;</span>
                    <span class="s2">else if </span><span class="s1">(ship-&gt;get_speed().second &lt; </span><span class="s3">0</span><span class="s1">)</span>
                        <span class="s1">player::to_down(ship</span><span class="s2">, </span><span class="s3">1</span><span class="s1">)</span><span class="s2">;</span>
                    <span class="s2">else</span>
                        <span class="s1">player::to_up(ship</span><span class="s2">, </span><span class="s3">1</span><span class="s1">)</span><span class="s2">;</span>

                    <span class="s1">ship-&gt;get_speed().first = x</span><span class="s2">;</span>
                <span class="s1">}</span>
                <span class="s2">else </span><span class="s1">{</span>
                    <span class="s2">double </span><span class="s1">x = ship-&gt;function(ship-&gt;get_rect().top + ship-&gt;get_speed().second - ship-&gt;get_start().second) + ship-&gt;get_start().first</span><span class="s2">;</span>
                    <span class="s1">ship-&gt;get_speed().first = (x - ship-&gt;get_rect().left) / constants::delta_time</span><span class="s2">;</span>
                    <span class="s2">double </span><span class="s1">y = ship-&gt;get_speed().second</span><span class="s2">;</span>
                    <span class="s1">x = ship-&gt;get_speed().first</span><span class="s2">;</span>
                    <span class="s1">ship-&gt;get_speed().first = abs(ship-&gt;get_speed().first)</span><span class="s2">;</span>
                    <span class="s2">if </span><span class="s1">(y == </span><span class="s3">0</span><span class="s1">)</span>
                        <span class="s1">player::to_stay_vertical(ship)</span><span class="s2">;</span>
                    <span class="s2">else if </span><span class="s1">(y &lt; </span><span class="s3">0</span><span class="s1">)</span>
                        <span class="s1">player::to_down(ship</span><span class="s2">, </span><span class="s3">1</span><span class="s1">)</span><span class="s2">;</span>
                    <span class="s2">else</span>
                        <span class="s1">player::to_up(ship</span><span class="s2">, </span><span class="s3">1</span><span class="s1">)</span><span class="s2">;</span>
                    <span class="s2">if </span><span class="s1">(x == </span><span class="s3">0</span><span class="s1">)</span>
                        <span class="s1">player::to_stay(ship)</span><span class="s2">;</span>
                    <span class="s2">else if </span><span class="s1">(x &lt; </span><span class="s3">0</span><span class="s1">)</span>
                        <span class="s1">player::to_left(ship</span><span class="s2">, </span><span class="s3">1</span><span class="s1">)</span><span class="s2">;</span>
                    <span class="s2">else</span>
                        <span class="s1">player::to_right(ship</span><span class="s2">, </span><span class="s3">1</span><span class="s1">)</span><span class="s2">;</span>

                    <span class="s1">ship-&gt;get_speed().second = y</span><span class="s2">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>


        <span class="s1">}</span>

        <span class="s2">void </span><span class="s1">create_bullet(main_gui_info *gui_info</span><span class="s2">, </span><span class="s1">game_elements &amp;game_elements) {</span>
            <span class="s2">if </span><span class="s1">(gui_info-&gt;fps - game_elements.player_ship-&gt;bullet_fps &gt;</span>
                <span class="s1">game_elements.player_ship-&gt;bullet_speed / constants::delta_time &amp;&amp;</span>
                <span class="s1">!sf::Keyboard::isKeyPressed(sf::Keyboard::Space)) {</span>
                <span class="s2">for </span><span class="s1">(</span><span class="s2">auto </span><span class="s1">i : game_elements.player_ship-&gt;bullet_cords) {</span>
                    <span class="s1">Rect&lt;</span><span class="s2">double</span><span class="s1">&gt; cords(game_elements.player_ship-&gt;sprite_rect().left + i.first</span><span class="s2">,</span>
                                       <span class="s1">game_elements.player_ship-&gt;sprite_rect().top + i.second</span><span class="s2">,</span>
                                       <span class="s3">16</span><span class="s2">, </span><span class="s3">54</span><span class="s1">)</span><span class="s2">;</span>
                    <span class="s1">game_elements.player_ship-&gt;bullet_fps = gui_info-&gt;fps</span><span class="s2">;</span>
                    <span class="s1">animation::player::create_bullet(cords</span><span class="s2">, </span><span class="s1">{</span><span class="s3">0</span><span class="s2">, </span><span class="s1">-</span><span class="s3">5</span><span class="s1">}</span><span class="s2">, </span><span class="s1">game_elements)</span><span class="s2">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
            <span class="s2">for </span><span class="s1">(</span><span class="s2">auto </span><span class="s1">&amp;i : *game_elements.enemy_ships) {</span>
                <span class="s2">if </span><span class="s1">(gui_info-&gt;fps - i-&gt;bullet_fps &gt; i-&gt;bullet_speed / constants::delta_time &amp;&amp; i-&gt;in_screen() &amp;&amp;</span>
                    <span class="s1">(gui_info-&gt;fps - i-&gt;last_bullets&gt; i-&gt;bullets_cooldown / constants::delta_time) ){</span>
                    <span class="s1">i-&gt;bullets_count++</span><span class="s2">;</span>
                    <span class="s2">for </span><span class="s1">(</span><span class="s2">auto </span><span class="s1">j : i-&gt;bullet_cords) {</span>
                        <span class="s1">Rect&lt;</span><span class="s2">double</span><span class="s1">&gt; cords(i-&gt;sprite_rect().left + j.first</span><span class="s2">, </span><span class="s1">i-&gt;sprite_rect().top + j.second</span><span class="s2">,</span>
                                           <span class="s3">16</span><span class="s2">, </span><span class="s3">54</span><span class="s1">)</span><span class="s2">;</span>
                        <span class="s1">animation::enemy::create_bullet(cords</span><span class="s2">, </span><span class="s1">{</span><span class="s3">0</span><span class="s2">, </span><span class="s3">3</span><span class="s1">}</span><span class="s2">, </span><span class="s1">game_elements)</span><span class="s2">;</span>
                    <span class="s1">}</span>
                    <span class="s2">if </span><span class="s1">(i-&gt;bullets_count &gt;= i-&gt;max_bullets_count) {</span>
                        <span class="s1">i-&gt;bullets_count = </span><span class="s3">0</span><span class="s2">;</span>
                        <span class="s1">i-&gt;last_bullets = gui_info-&gt;fps</span><span class="s2">;</span>
                    <span class="s1">}</span>
                    <span class="s1">i-&gt;bullet_fps = gui_info-&gt;fps</span><span class="s2">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>

    <span class="s1">}</span>
<span class="s1">}</span></pre>
</body>
</html>